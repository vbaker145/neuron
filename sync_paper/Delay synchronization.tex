\documentclass[a4paper,11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[font=scriptsize]{caption}
\usepackage{wrapfig}
\usepackage[backend=biber]{biblatex}

\addbibresource{nn.bib}
\renewcommand\thesubsection{\alph{subsection}}


%opening
\title{One-dimensional traveling waves in neural minicolumns}
\author{Vince Baker, advisor: Dr. Luis Cruz Cruz\\ Drexel University Department of Physics}

\begin{document}

\maketitle

\begin{abstract}
Cortical traveling waves have been observed in vivo and in simulations of recurrent networks.
These traveling waves explain various features of cortical dynamics including spike timing variability and correlated fluctuations in membrane potential.
In this work we examine the firing dynamics of neural column structures similar to those found in the cortex.
We find that traveling waves are evoked by random background stimulus in networks with distance-dependent connectivity and propagation delay.
We determine that the propagation velocity of the waves is determined by both the action potential propagation time and the topology of the column.
This topological dependence of wave propagation may indicate a functional role of the cortex organization into columns and microcolumns.

\end{abstract}

\section{Introduction} 
Traveling waves of cortical neuron activation have been observed in vivo, in vitro and in silico. 
Proposed functions of these traveling waves include motor coordination, place field coordination in the hippocampus, and spatiotemporal processing in the visual cortex \cite{muller2018}. 
Advanced experimental techniques that achieve the required spatial and temporal resolution \cite{shoham1999} to capture the mesoscopic traveling waves have focused on lateral activity near the cortical surface, and simulations of traveling waves in a 2-D sheet of neurons have been performed \cite{keane2015}. 
In this work we explore the dynamics of traveling waves along the vertical column structures found in the cortex.
We find that 1-D traveling waves can propagate in simulated neural microcolumn structures with certain properties including distance-dependent connectivity and a mix of excitatory and inhibitory neurons. 
We observe wave properties including creation from background stimulus, annihilation between waves, and a wave group velocity that is determined by both the neural phase velocity (action potential propagation speed down a synapse) and the column topology. 
The topological dependence of wave speed is especially interesting as it may contribute to the functional organization of the cortex into minicolumns.
\\
The cerebral cortex is organized into six layers distinguished by the types of neurons and connections found in each layer.
The layers are connected to each other by microcolumns \cite{cruz2005}, a structure of about 100 neurons that is a few tens of microns thick and several millimeters long.
The existence of these microcolumns is well established but their function remains unclear \cite{horton2005}. 
Prevous work on mesoscopic traveling waves in the cortex has largely focused on lateral waves within the layers \cite{muller2018}.
\\
Several types of cortical propagating waves have been studied.
Slow, large-scale wave activity have been observed in sleep and anesthetized states \cite{muller2018}.
Advances in optical imaging techniques using voltage-sensitive dye provided sufficient spatial resolution to observe local area mesoscopic traveling waves in the awake cortex \cite{wu2008}.
From a theoretical standpoint neuronal waves have been studied as networks of coupled oscillators \cite{ermentrout2001}. 
Although the Izhekevich model is capable of producing self-resonant oscillations when tuned appropriately, the model parameters used in this work did not show any evidence of self-oscillation.
The waves studied in the present work seem to fall instead into the general category of propagating pulses in an excitable network described in \cite{ermentrout2001}. \\
Stimulus-evoked mesoscopic waves have been observed in the visual and auditory system. 


\section{Methods}
We simulated the dynamics of a small neural column to explore neuron synchronization.
Our network geometry is based on the model presented in \cite{markram1998}.
An example neural column composed of 135 neurons on a unit grid spacing, 3x3 neurons wide and 9 neurons high as shown in figure \ref{fig:column_structure}.
\begin{figure}[!htb]
 \caption{Column structure used in this research, $\lambda=2$,$C=1$,}
 \label{fig:column_structure}
 \centering
   \includegraphics[width=0.48\textwidth]{fig/lambda2}
\end{figure}
The neurons are connected with a strong local connectivity according to the distance-based connection probability:
\begin{align}\label{eq:connectivity}
 P_{a,b} &= C \times e^{-(D(a,b)/\lambda)^2}
\end{align}
Where $D(a,b)$ is the distance between neuron A and B and $\lambda$ and $C$ are parameters of the connection model.
\\ \\
We model the neurons using the Izhikevich model \cite{izhikevich2003} to allow us to explore the neural dynamics.
The Izhikevich model uses two coupled differential equations with two variables and four parameters:
\begin{align}
 v^\prime &= 0.04v^2+5v+140-u+I\\
 u^\prime &= a(bv-u)\\
 \text{if } &v>30: v\leftarrow c, u\leftarrow u+d
\end{align}
This is a simplified model of a two-dimensional dynamical system.
This model has been used to reproduce common neural firing patterns.
There is MATLAB code available \cite{izzy_code} that implements this neural model with fixed, single-time-step action potential propagation.
We enhanced the available MATLAB code for the Izhikevich model to incorporate a more realistic propagation model while still minimizing computational complexity.
Our model incorporates a propagation delay $\kappa D(a,b)$ porportional to the inter-neuron distance $D(a,b)$. 
We also model an exponentially decaying synapse respone with a time constant of $4~ms$.
\\ \\
We capture the firing events from all neurons in each simulation.
We then perform a spatial clustering operation to identify spatiotemporal regions with a high firing density.
This clustering operation removes random background firing activity.
We then identify and label the traveling wave structures that evolve over time as shown in Figure \ref{fig:wave_analysis}.
\begin{figure}[!htb]
 \caption{A: Neuron firings in a column with 30\% excitatory neurons. B: The resulting cluster points (black) and an example of a labeled wave (red).
          C: Neuron firings in a column with 80\% excitatory neurons. D: The resulting cluster points (black) and an example wave (red).}
 \label{fig:wave_analysis}
 \centering
   \includegraphics[width=0.75\textwidth]{fig/WaveAnalysisExample}
\end{figure}


\section{Results}
The original Izhekevich simulation \cite{izzy_code} demonstrates synchronized firing in a completely connected neural field with random background stimulus.
We replicated this simulation by setting our column to have complete connectivity corresponing to $\lambda \rightarrow \infty$: all neurons are connected to all other neurons.
We used a constant delay for every action potential regardless of the inter-neuron distance.
The result was highly synchronized simultaneous firing among all neurons in the column (Figure \ref{fig:sync_fire}). \\ 
We then incorporated our distance-dependent action potential propagation. 
The firing is still highly synchronized, but traveling waves are now evident (Figure \ref{fig:sync_fire_delay}).
This demonstrates that one dimensional traveling waves can emerge from fully-connected networks if the propagation time is porportional to the inter-neuron distance.
\begin{figure}[!htb]
  \centering
  \begin{minipage}{0.45\textwidth}
      \centering
      \includegraphics[width=0.95\textwidth]{fig/IzzySync}
      \caption{Synchronized, simultaneous firing in a completely connected column with constant propagation delay.}
      \label{fig:sync_fire}
  \end{minipage}\hfill
  \begin{minipage}{0.45\textwidth}
      \centering
      \includegraphics[width=0.9\textwidth]{fig/IzzySync_Delay}
      \caption{Traveling waves emerge when the propagation delay is porportional to the inter-neuron distance. }
      \label{fig:sync_fire_delay}
  \end{minipage}
\end{figure}

We next investigate our locally connected network.
The neuron connectivity was determined by inter-neuron distance as described in Methods Eq. \ref{eq:connectivity}, with $\lambda=2.5$ and $C=1$.
This results in $\approx 3.5\%$ of the possible neuron connections realized.  
The lower overall connectivity in the network requires an increase in the average connection strength to observe traveling waves.
In Figure \ref{fig:strength_effect} we show typical traveling waves for different levels of connection strength relative to the baseline.
We see that traveling waves emerge when the connection strength is increased to roughly 4x the original strength.
\begin{figure}[!htb]
 \caption{Effect of connection strength on traveling wave formation. $K$ is the connection strength enhancement relative to the baseline.}
 \centering
   \includegraphics[width=0.3\textwidth]{fig/ConnectionStrengthWaves}  
 \label{fig:strength_effect}
\end{figure}

The excitatory/inhibitory balance is known to have a significant impact on neural network dynamics \cite{keane2015}. 
In our microcolumn model we do not observe traveling waves if less than $40\%$ of the neurons are excitatory.
As the fraction of excitatory neurons increase we observe traveling wave patterns emerge from the background firing events.
As the excitatory fraction increases more of the firing events occur within waves structures (Figure \ref{fig:excitatory_effect}).
When all neurons are excitatory the traveling waves are the dominat mode of firing, with substantially all of the firing events contained within traveling waves. \\
\begin{figure}[!htb]
 \caption{Excitatory/inhibitory balance effect on traveling waves.. 
	  For columns with $<40\%$ excitatory neurons no waves are observed.
	  As the excitatory fraction approaches 1 nearly all firing events are part of traveling waves.
	  }
 \label{fig:excitatory_effect}
 \centering
   \includegraphics[width=0.5\textwidth]{fig/ExcitatoryWaves}
\end{figure}
To examine the speed of the traveling waves we stimulated the lowest 5 layers of neurons in the column with a step stimulus lasting 20 ms starting at $t=20~ms$..
This generates a single traveling wave with a determined start time, simplifying the propagation velocity measurement.
A typical stimulated wave is shown in Figure \ref{fig:wave_example}.
\begin{figure}[!htb]
 \caption{Single traveling wave resulting from a step stimulus at the bottom of the column.}
 \label{fig:wave_example}
 \centering
   \includegraphics[width=0.5\textwidth]{fig/TypicalWave}
\end{figure}
In \cite{muller2018} the authors noted that mesoscopic traveling waves typically have propagation speeds from 0.1 to 0.8 meters per second, consistent with axonal conduction speed of unmyelinated fibers.
Our linear model of synpatic conduction delay is linear with inter-neuron distance, with a porportionality constant $\kappa$.
We expected longer synaptic conduction delays to result in slower wave propagation.
The column topology can also influence the propagation speed.
Columns with a larger cross-section have a larger number of neurons and synapses for a given length, providing more pathways for the traveling wave to propagate. \\
Simulations show that the synaptic propagation delay parameter $\kappa$ does effect the wave propagation as expected, but the effect is not linear (Figure \ref{fig:delay_topology}).
If the traveling wave velocity was determined by the acton potential propagation speed we would expect to see wave velocity of 1000 units/second with $\kappa=1$.
Instead the wave velocity is less than half the simple prediction.
A four-fold increase in $\kappa$ does not reduce the traveling wave propagation speed by a factor of 4. \\
The column topology also has a significant impact on wave propagation speed, with waves in the thinner 2x2 columns traveling about $25\%$ slower than in the 3x3 column.
Real microcolumns will have a less regular structure and we may expect them to show a more continuous variation in wave propagation speed. 

\begin{figure}[!htb]
 \caption{Wave speed is inversely porportional to $\kappa$ as expected. Wave speed also increases with the column cross-section.Mean values with $1\sigma$ errorbars, 50 trials.}
 \label{fig:delay_topology}
 \centering
   \includegraphics[width=0.6\textwidth]{fig/WaveSpeed_DelayTopology}
\end{figure}


\section{Future work}


\clearpage
\printbibliography

\end{document}
